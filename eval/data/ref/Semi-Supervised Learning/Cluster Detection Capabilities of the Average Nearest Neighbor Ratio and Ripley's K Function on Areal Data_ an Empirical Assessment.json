{
    "from": "arxiv",
    "scholar_id": null,
    "detail_id": "arXiv:2204.10882",
    "title": "Cluster Detection Capabilities of the Average Nearest Neighbor Ratio and Ripley's K Function on Areal Data: an Empirical Assessment",
    "abstract": "Spatial clustering detection methods are widely used in many fields including epidemiology, ecology, biology, physics, and sociology. In these fields, areal data is often of interest; such data may result from spatial aggregation (e.g. the number disease cases in a county) or may be inherent attributes of the areal unit as a whole (e.g. the habitat suitability of conserved land parcel). This study aims to assess the performance of two spatial clustering detection methods on areal data: the average nearest neighbor (ANN) ratio and Ripley's K function. These methods are designed for point process data, but their ease of implementation in GIS software (e.g., in ESRI ArcGIS) and the lack of analogous methods for areal data have contributed to their use for areal data. Despite the popularity of applying these methods to areal data, little research has explored their properties in the areal data context. In this paper we conduct a simulation study to evaluate the performance of each method for areal data under various areal structures and types of spatial dependence. These studies find that traditional approach to hypothesis testing using the ANN ratio or Ripley's K function results in inflated empirical type I rates when applied to areal data. We demonstrate that this issue can be remedied for both approaches by using Monte Carlo methods which acknowledge the areal nature of the data to estimate the distribution of the test statistic under the null hypothesis. While such an approach is not currently implemented in ArcGIS, it can be easily done in R using code provided by the authors.",
    "bib_name": "vidanapathirana2022clusterdetectioncapabilitiesaverage",
    "md_text": "# Cluster Detection Capabilities of the Average Nearest Neighbor Ratio and Ripley\u2019s K Function on Areal Data: An Empirical Assessment \nNadeesha Vidanapathirana1, Yuan Wang1, Alexander C. McLain1, Stella Self1   1Department of Biostatistics and Epidemiology, University of South Carolina, Columbia, SC. \nSpatial clustering detection methods are widely used in many fields including epidemiology,  ecology, biology, physics, and sociology. In these fields, areal data is often of interest; such data  may result from spatial aggregation (e.g. the number disease cases in a county) or may be inherent  attributes of the areal unit as a whole (e.g. the habitat suitability of conserved land parcel). This  study aims to assess the performance of two spatial clustering detection methods on areal data:  the average nearest neighbor (ANN) ratio and Ripley\u2019s K function. These methods are designed  for point process data, but their ease of implementation in GIS software (e.g., in ESRI ArcGIS)  and the lack of analogous methods for areal data have contributed to their use for areal data.  Despite the popularity of applying these methods to areal data, little research has explored their  properties in the areal data context.  In this paper we conduct a simulation study to evaluate the  performance of each method for areal data under various areal structures and types of spatial  dependence. These studies find that traditional approach to hypothesis testing using the ANN ratio  or Ripley\u2019s K function results in inflated empirical type I rates when applied to areal data.  We  demonstrate that this issue can be remedied for both approaches by using Monte Carlo methods  which acknowledge the areal nature of the data to estimate the distribution of the test statistic  under the null hypothesis.  While such an approach is not currently implemented in ArcGIS, it can  be easily done in R using code provided by the authors. \nResearchers have been using spatial clustering analysis for many years to analyze data for spatial  patterns. One of the earliest examples of spatial clustering analysis in public health occurred when  John Snow mapped the location of cholera cases to identify the source of an outbreak in London  in 1894 (Moore & Carpenter, 1999). Over the past few decades, the popularization of geographical  information systems (GIS) software has led to the development of many new methods for spatial  analysis. A Google Scholar search for \u2018spatial clustering\u2019 returns 15,600 results published from  2001 to 2010, with an increase to 28,000 results published from 2011 to 2020.   Both point process  (latitude-longitude) and areal data can exhibit spatial patterns, and a variety of methods have been  developed to analyze spatial patterns in both types of data.    One of the oldest techniques for detecting spatial clustering is the average nearest neighbor (ANN)  ratio (Clark & Evans, 1954).  Given a set of \u2018observation locations\u2019 (e.g. coordinate locations of a  specific plant species, street addresses of violent crimes, etc.), the ANN method computes the  distance between each observation location and its nearest neighbor and uses the average \u2018nearest  neighbor distance\u2019 to compute a test statistic. The ANN ratio has been widely used to detect  clustering in various types of point process data, including disease cases (Aziz et al., 2012;  Khademi et al., 2016; Melyantono, Susetya, Widayani, Tenaya, & Hartawan, 2021), crime  hotspots (Brookman-Amissah, Wemegah, & Okyere, 2014; Wing & Tynon, 2006; Z. Zhang et al.,  2020) and archeological artifacts (K\u0131ro\u011flu, 2003; Whallon, 1974).  The ANN ratio has also been  used to detect clustering in areal data (after mapping to centroids) in disease case data (Mollalo,  Alimohammadi, Shirzadi, & Malek, 2015) aggregated to the municipality level.  Ripley\u2019s K function was first developed in 1976 and can simultaneously describe spatial patterns  at different scales. For a given distance \ud835\udc61, Ripley\u2019s K function returns the expected number of  observation locations within a distance of \ud835\udc61 from a randomly selected observation location. \nRipley\u2019s K function can be used to determine if data are clustered (or dispersed) at a specific  geographic scale determined by \ud835\udc61.  Ripley\u2019s K function has been used to assess point process data  for clustering in a variety of fields including epidemiology (Hohl, Delmelle, Tang, & Casas, 2016;  Lentz, Blackburn, & Curtis, 2011; Ramis et al., 2015), ecology  (Haase, 1995; Moeur, 1993; Wolf,  2005), and sociology (Lu & Chen, 2007; Vadlamani & Hashemi, 2020).  It has also been applied  to areal data (after mapping the areal units to their centroids) in a variety of applications including  disease case data aggregated at the municipality level (Karunaweera et al., 2020; Mollalo et al.,  2015; Skog, Linde, Palmgren, Hauska, & Elgh, 2014), locations of conserved land (Zipp, Lewis,  & Provencher, 2017), locations of land parcels in industrial use (Qiao, Huang, & Tian, 2019),  human-wildlife interactions (Kretser, Sullivan, & Knuth, 2008), and rockfall events (Tonini &  Abellan, 2014).  The ANN ratio and Ripley\u2019s K function were developed for point process data. However,  Environmental Systems Research Institute (ESRI) ArcGIS software allows the user to implement  both these methods on areal data using their Average Nearest Neighbors Tool (ANN ratio) and the  Multidistance Spatial Cluster Analysis Tool (Ripley\u2019s K function); both tools are in the Spatial  Statistics Toolbox. When the user applies either method to areal data (i.e. polygon features),  ArcGIS automatically maps each polygon feature to its centroid and applies the method to the  resulting set of points (Esri, 2021a; Esri, 2021b). To our knowledge, the performance of the ANN  ratio and Ripley\u2019s K function under these conditions has never been evaluated. Both methods  assume that under the null hypothesis, the observation locations arise from a homogenous Poisson  process. However, for areal data the centroids of smaller units tend to be closer to the centroids of  their neighbors when compared to the centroids of larger units, making it improbable that the  locations of the centroids will follow a homogeneous Poisson process even in the absence of spatial \nclustering. As the homogeneous Poisson process assumption is likely violated for most areal data  structures, it is advisable to assess the performance (i.e. empirical type I error rate and empirical  power) of the ANN ratio and Ripley\u2019s K function when applied to areal data.    In this paper, we conduct a simulation study to evaluate the performance of each method as  implemented in ArcGIS for areal data under different types of spatial dependence and areal  structures.  We compare the performance of each method under the standard ArcGIS  implementation with an alternate implementation in which the null distribution of each test statistic  is estimated using Monte Carlo methods that acknowledge the underlying areal structure of the  data. Section 2 presents a detailed description of the two spatial clustering methods.  Section 3  describes the simulation study and Section 4 describes its results. Section 5 contains discussion  and concluding remarks. \n# 2 Methods \nThe ANN ratio and Ripley\u2019s K function can be used to perform a hypothesis test for the presence  of spatial clustering or dispersion.  Traditionally, the null hypothesis for each of these tests is that  the observed locations exhibit complete spatial randomness (CSR), that is, the observation  locations arise from a two-dimensional homogeneous Poisson process. Formally, a stochastic  process is said to be a homogeneous Poisson process with rate \ud835\udf06 if the number of events in any  bounded region \ud835\udc34, denoted \ud835\udc41(\ud835\udc34), is Poisson distributed with mean intensity \ud835\udf06|\ud835\udc34|, that is,  Pr(\ud835\udc41(\ud835\udc34) = \ud835\udc5b) = \ud835\udc52\u2212\ud835\udf06|\ud835\udc34|(\ud835\udf06|\ud835\udc34|)\ud835\udc5b/\ud835\udc5b!, where |\ud835\udc34| denotes the area of \ud835\udc34. Given that there are \ud835\udc5b events  in \ud835\udc34, those events form an independent random sample from a uniform distribution on \ud835\udc34 (Cressie,  1994). \nThe average nearest neighbor (ANN) ratio was initially developed to classify spatial patterns in  plant populations (Clark & Evans, 1954). In this context, the observation locations consist of  locations of observed plants, measured as coordinates in two-dimensional space. This method  quantifies the randomness (or lack thereof) among the observed point locations by measuring the  distance from each point to its nearest neighbor and using these distances to compute the average  nearest neighbor (ANN) ratio given by \n# \ud835\udc45= \ud835\udc5f\u0305\ud835\udc42 \ud835\udc5f\u0305\ud835\udc38  \nwhere \ud835\udc5f\u0305\ud835\udc42= \u2211 \ud835\udc5f\ud835\udc56 \ud835\udc41 \ud835\udc56=1 \ud835\udc41  , \ud835\udc5f\ud835\udc56 denotes the distance from the \ud835\udc56\ud835\udc61\u210e individual to its nearest neighbor, \ud835\udc41 denotes  the total number of observations, \ud835\udc5f\ud835\udc38= 1 2\u221a\ud835\udf0c is the expected value of \ud835\udc5f\ud835\udc42 under CSR for an infinite  study area, \ud835\udf0c= \ud835\udc41 |\ud835\udc34| is the density of the observed distribution, and |\ud835\udc34| is the size of the study area.  Under CSR, \ud835\udc38(\ud835\udc45) = 1, and for a perfectly clustered distribution (i.e., all points fall at the same  location), \ud835\udc38(\ud835\udc45) = 0. Values of \ud835\udc45 greater than 1 indicate that the points are distributed more  uniformly than expected under CSR, while values less than 1 indicate that the points are clustered.  The standard approach to hypothesis testing using the ANN ratio assumes that the distribution of  \ud835\udc5f\ud835\udc42 under the null hypothesis of CSR is approximately normal. A z-score for the statistic is  calculated by \nwhere  \ud835\udf0e\ud835\udc5f\u0305\ud835\udc38 is the standard error of the mean distance to the nearest neighbor under CSR. It can be  shown that under CSR with an infinite study area, \ud835\udf0e\ud835\udc5f\u0305\ud835\udc38= 0.26136 \u221a\ud835\udc41\ud835\udf0c. A significantly negative z-score \n(1)\n(2)\nindicates clustering, and a significantly positive score indicates dispersion. See Figure 1 for  examples of clustering, dispersion, and complete spatial randomness.    Clark and Evans (1954) note some limitations of their procedure, such as the sensitivity to the  chosen study area and inability to distinguish between certain types of spatial dependence (e.g.,  tightly clustered points in one place vs pairs of points scattered in population). In this situation,  they suggest an extension to this measure by constructing a circle for each observation with an  infinite radius, dividing the circle into equal sectors, and measuring the distance from the  individual to its nearest neighbor for each of the sectors. They also point out that problems may  arise when the data consist of large areal units rather than points and the centroid of each unit is  used to calculate the ANN ratio (Clark & Evans, 1954).   In the areal data context, the observations consist of a set of areal units (e.g. counties, census tracts,  etc.), with some subset of these units having some characteristic of interest (e.g. counties which  imposed a mask mandate during the COVID-19 pandemic, census tracts deemed to be food deserts,  etc.).  The \u2018standard implementation\u2019 of ANN-based hypothesis testing for such datasets (i.e. the  approach taken by ESRI ArcGIS) is to map each areal unit to its centroid, compute the z-score  given in Equation 2, and make a rejection decision by comparing this z-score to the quantiles of a  standard normal distribution.   We propose an alternate \u2018areal implementation\u2019 which  acknowledges the underlying areal unit structure.  Under this approach, the null distribution of the  ANN ratio z-score is estimated using Monte Carlo simulations where the data for each simulation  is generated by randomly selecting \ud835\udc41 observation locations from among the areal unit centroids.  The ANN ratio z-score is computed for each dataset, empirical quantiles of the ANN ratio under  the null distribution are calculated, and a decision is made by comparing the ANN ratio z-score  from the observed dataset to these empirical quantiles. \nOne of the limitations of the ANN method is its inability to test point patterns at different scales  simultaneously (Ripley, 1977). For example, it is possible for data to be clustered at a small scale  and clustered at a larger scale (i.e., the clusters are clustered) or clustered at a small scale but  dispersed at a large scale (i.e., the clusters occur at somewhat regular intervals). Ripley\u2019s \ud835\udc3e function is a second-order spatial analysis tool (i.e., uses variances of the distances between observations) that can address the issue of scale-dependent spatial patterns. Here we only consider Ripley\u2019s \ud835\udc3e function for univariate spatial patterns in two dimensions, but it can also be extended  for multivariate spatial patterns (i.e.: comparing spatial patterns of two species) (Dixon, 2001). Let \ud835\udc5b\ud835\udc61(\ud835\udc60) denote the number of points within radius t at point s.  The function \ud835\udc3e is given by \n# \ud835\udc3e(\ud835\udc61) = \ud835\udc38(\ud835\udc5b\ud835\udc61(\ud835\udc60)) \ud835\udf06 , \nwhere \ud835\udf06 is the density (number of points per unit area) and can be estimated as \ud835\udf06\u0302 = |\ud835\udc34|, \ud835\udc41 is the observed number of points and |\ud835\udc34| is the size of the study area. The expectation is taken over the point locations.  If the points follow a homogenous Poisson process (i.e., exhibit CSR), then \ud835\udc3e(\ud835\udc61) = \ud835\udf0b\ud835\udc612 which is the area of a circle of radius \ud835\udc61. An approximately unbiased estimator for \ud835\udc3e(\ud835\udc61) was proposed by Ripley (Dixon, 2001; Ripley, 1976): \nwhere \ud835\udc51\ud835\udc56\ud835\udc57 is the distance between the \ud835\udc56\ud835\udc61\u210e and \ud835\udc57\ud835\udc61\u210e points, \ud835\udc3c(\ud835\udc51\ud835\udc56\ud835\udc57< \ud835\udc61) is the indicator function with  the value of 1 if \ud835\udc51\ud835\udc56\ud835\udc57< \ud835\udc61 and 0 otherwise, and \ud835\udc64\ud835\udc56\ud835\udc57 \u22121 is a weight associated with locations \ud835\udc56 and \ud835\udc57 that  corrects for edge effects. Correction for edge effects is required if any distance \ud835\udc51\ud835\udc56\ud835\udc57 is greater than  the distance between point \ud835\udc56 and the boundary. Because the points outside the boundary are not \n(3)\nincluded in the calculation of \ud835\udc3e\u0302(\ud835\udc61), edge effects can lead to a biased estimator of \ud835\udc3e(\ud835\udc61). Various  authors have proposed different edge corrections, such as buffer zones (Sterner, Ribic, & Schatz,  1986; Szwagrzyk, 1990) or toroidal edge corrections (Ripley, 1979; Upton & Fingleton, 1985).  One of the most commonly used edge corrections assigns \ud835\udc64\ud835\udc56\ud835\udc57 a value of 1 if the circle centered at  point \ud835\udc56 which passes through point \ud835\udc57 is entirely inside the study area and assigns \ud835\udc64\ud835\udc56\ud835\udc57 equal to the  proportion of the circumference of the circle that falls in the study area otherwise (Dixon, 2001).  To test for CSR, the estimator \ud835\udc3f\u0302(\ud835\udc61) = [\ud835\udc3e\u0302(\ud835\udc61)/\ud835\udf0b]1/2 is sometimes used in practice, and \ud835\udc38(\ud835\udc3f\u0302(\ud835\udc61)) = \ud835\udc61 under CSR (Ripley, 1979). If the observed value of \ud835\udc3e(\ud835\udc61) is larger than the expected value of  \ud835\udc3e(\ud835\udc61) for a given distance, the distribution is more clustered than expected under CSR at that  distance. If the observed value of \ud835\udc3e(\ud835\udc61) is smaller than the expected value of \ud835\udc3e(\ud835\udc61), the distribution  is more dispersed than expected under CSR at that distance.  Usually, the distribution of \ud835\udc3e\u0302(\ud835\udc61)  under the null hypothesis of CSR is estimated via Monte Carlo simulations, and critical values  from the simulated distribution are used to define a rejection region for hypothesis testing.  Computing Ripley\u2019s K function can be computationally expensive for large datasets, as the number  of distances between each pair of points must be computed.  If inference is required, these  computations must be repeated for each dataset generated in the Monte Carlo simulations.  Several  computationally efficient methods have been suggested for use on large datasets.  Tang, Feng, and  Jia (2015) develop a massively parallel algorithm which uses graphical processing units (GPUs)  to compute Ripley\u2019s K function for large datasets. G. Zhang, Huang, Zhu, and Keel (2016) propose  two methods for computing Ripley\u2019s K which combines cloud computing with pre-sorting and  efficient storage to reduce computation time.  Wang et al. (2020) develop a distributed computing  algorithm to compute Ripley\u2019s K function for large spatial-temporal datasets using Apache Spark.  In addition to these methods, a number of software packages exist which are suitable for computing \nRipley\u2019s K on smaller datasets, including the Multi-distance Spatial Cluster Analysis Tool in ESRI  ArcGIS (Esri. (2021b)), the spatstat package in R (Baddeley & Turner, 2021), and the splancs  package in R (Bivand et al., 2017).  The \u2018standard implementation\u2019 of hypothesis testing using Ripley\u2019s K for areal datasets (and the  approach used by ESRI ArcGIS) is to map each areal unit to its centroid and compute \ud835\udc3e\u0302(\ud835\udc61) (or  sometimes \ud835\udc3f\u0302(\ud835\udc61)) using the resulting set of points.  The null distribution of \ud835\udc3e\u0302(\ud835\udc61) is estimated using  Monte Carlo simulations where each dataset consists of \ud835\udc41 observation locations generated from a  continuous uniform distribution on the study area, that is, the locations exhibit CSR.  Hypothesis  testing proceeds by comparing the \ud835\udc3e\u0302(\ud835\udc61) value from the original dataset to the empirical quantiles  from the Monte Carlo simulations.  We propose an alternate \u2018areal implementation\u2019 for performing  hypothesis testing using Ripley\u2019s K function.  Under this implementation, the null distribution is  again estimated using Monte Carlo simulations, but observation locations for each dataset are  generated by randomly selecting \ud835\udc41 points from among all the areal unit centroids.  The \ud835\udc3e\u0302(\ud835\udc61) from  the original dataset is then compared to the empirical quantiles from the Monte Carlo simulations  to make a rejection decision. \n# 3 Simulations \nA simulation study was conducted to assess the performance the standard and areal  implementations of hypothesis testing using ANN ratio and Ripley\u2019s K function.  In this study, we  consider three areal unit structures: structure \ud835\udc341 is a 20 \u00d7 20 regular grid where the units are of  the same size, structure \ud835\udc342 is the United States (US) counties in the states of North Carolina,  Tennessee, South Carolina, Georgia, Alabama, and Mississippi where the units (counties) are  roughly the same size but irregularly shaped, and structure \ud835\udc343 is the Canadian forward sortation \nareas (FSAs) in the provinces of Alberta, Saskatchewan, and Manitoba where the units have vastly  different sizes. Areal structures \ud835\udc341, \ud835\udc342, and \ud835\udc343 contain \ud835\udc5b1 = 400, \ud835\udc5b2 = 549, and \ud835\udc5b3 = 267 areal  units, respectively. Observed data consists of a subset of the areal units presumed to have some  characteristic of interest, and data generation consists of selecting this subset of units. We generate  data under CSR and under two different types of clustering for two sample sizes. For each scenario,  500 datasets are simulated.  Data is generated by selecting the observed units from among the \ud835\udc5b\ud835\udc4e total units present in areal  structure \ud835\udc34\ud835\udc4e. We consider two sample sizes for each areal structure: \ud835\udc41= \u230a \ud835\udc5b\ud835\udc4e 10\u230b and \ud835\udc41= \u230a \ud835\udc5b\ud835\udc4e 4 \u230b, and  generate data under the null hypothesis of no spatial pattern (data generation mechanism (DGM)  \ud835\udc371) and under two alternative hypotheses: a single large cluster (DGM \ud835\udc372) and multiple smaller  clusters (DGM \ud835\udc373). Under DGM \ud835\udc371, which corresponds to no spatial pattern, the observed units  are selected via uniform sampling without replacement from among the \ud835\udc5b\ud835\udc4e total units. Under DGM  \ud835\udc372, which corresponds to the single cluster, units in a pre-selected region of the study area are  sampled with 10 times higher probability than the units in the rest of the study area. The regions  of higher probability are shown in grey in Figure 2.  DGM \ud835\udc373, which corresponds to multiple  clusters, is an iterative process. First, an areal unit is selected via uniform random sampling, and  this unit is observed, along with units which are directly adjacent to it. Another areal unit is then  sampled without replacement from the remaining unobserved units and is observed along with all  adjacent units. This process is continued until \ud835\udc41 units have been observed. Examples of data  generated on each areal structure under DGMs \ud835\udc371, \ud835\udc372 and \ud835\udc373 are shown in Figures 3-5,  respectively.  The ANN ratio is calculated by using the centroids of the observed units as the observation  locations. The ANN ratio is known to be sensitive to the choice of the study area (often referred to \nas the window); we consider two different methods for selecting the window: window 1 is the  entire study area and window 2 is the smallest possible rectangle that encloses all the observed  locations (note that window 2 is dependent on the observed data, while window 1 is not).  For the  standard implementation of the ANN method, the null distribution of the test statistic is assumed  to be a standard normal distribution.  For the areal implementation, the null distribution of the  ANN ratio is estimated using 999 Monte Carlo simulations.  For both implementations, for DGM  \ud835\udc371 we perform an \ud835\udefc= 0.05 level two-tailed test by rejecting the null hypothesis if the test statistic  is less than the 0.025 quantile or greater than the 0.975 quantile of the null distribution. For DGMs  \ud835\udc372 and \ud835\udc373, we perform a left-tailed test (indicative of clustering) by rejecting the null hypothesis  if the test statistic falls below the 0.05 quantile of the estimated null distribution.  Ripley\u2019s K function was also evaluated using the centroids of the observed units as the observation  locations.  For each areal structure, the performance of Ripley\u2019s K function was evaluated at a  sequence of five radii, with the smallest radius equal to twice the smallest distance between any  two unit centroids and the largest radius equal to one-quarter of the width of the study area. For  each dataset, Ripley\u2019s K function is evaluated at each radius using the Kest function in R (Baddeley  & Turner, 2005) with the correction input as \u201cRipley\u201d.  Under the standard implementation, the  null distribution of Ripley\u2019s K function at each radius is approximated with 999 Monte Carlo  simulations, where the \ud835\udc41 observation locations for each simulation are generated from a  continuous uniform distribution on the study area.  Under the areal implementation, the null  distribution of Ripley\u2019s K function at each radius is approximated with 999 Monte Carlo  simulations where the \ud835\udc41 observation locations are selected at random from the \ud835\udc5b\ud835\udc34 areal unit  centroid locations.  For both implementations, for DGM \ud835\udc371 we perform an \ud835\udefc= 0.05 level twotailed test for each radius \ud835\udc5f by rejecting the null hypothesis if \ud835\udc3e\u0302(\ud835\udc61) is less than the 0.025 quantile \nor greater than the 0.975 quantile of the null distribution. For DGMs \ud835\udc372 and \ud835\udc373, we perform a  right-tailed test (indicative of clustering) by rejecting the null hypothesis if \ud835\udc3e\u0302(\ud835\udc61) exceeds the 0.95  quantile of the Monte Carlo samples.   We assess the performance via empirical type I error rate and empirical power. For simulations  under the null hypothesis (\ud835\udc371), we report the global empirical type I error rate for the ANN ratio  and the empirical type I error rate at each radius for Ripley\u2019s K function. For simulations under  alternative hypotheses (\ud835\udc372 and \ud835\udc373), we report the global empirical power for the ANN ratio and  the empirical power at each radius for Ripley\u2019s K function.  \n# 4  Results\nTable 1 summarizes the empirical type I error rate (i.e., empirical probability of rejecting the null  hypothesis of CSR when units are generated under CSR) and empirical power (i.e., the empirical  probability of rejecting the null hypothesis of CSR when units are clustered) of the ANN ratio  under both implementations.  Under the standard implementation, the empirical type I error rate is  inflated under all scenarios except the US counties under window 2.  The inflation is generally  more pronounced for the smaller sample size.  Under the areal implementation, the empirical type  I error rate is at its nominal level.  However, the empirical power of the areal implementation is  somewhat low (<50%) for all single cluster scenarios except the US counties under window 1.  The empirical power for of the areal implementation under the multiple cluster scenarios is high  (>90%) for the regular grid and the US counties, but somewhat lower (50-65%) for the Canadians  FSAs.  In most scenarios, the empirical power of the areal implementation of the ANN methods is  higher for window 1 (the entire study area) than window 2 (the smallest enclosing rectangle). \nTable 2 summarizes the empirical type I error and the empirical power of Ripley\u2019s K function  under both implementations.  The empirical type I error rate of the standard implementation is far  above its nominal level in all cases except for the Canadian FSAs under the smallest radius and  smallest sample size.  The empirical type I error rate of the areal implementation is at or near its  nominal level for all scenarios, ranging from 0.02 to 0.09.  The empirical power of the areal  implementation is high for most of the single cluster scenarios, with the notable exception of  Canadian FSAs under the smallest radius.  The empirical power of the areal implementation for  the multiple cluster scenario is quite high (>90%) for all radii and sample sizes for the regular grid.  The empirical power of the areal implementation for the multiple cluster scenarios for the other  two areal structures is highest for the second smallest radii with a notable decline as the radius  increases.  Since the multiple clustering scenario consists of small clusters which are randomly  dispersed (as opposed to large clusters or clusters of clusters), this is to be expected.   \n# 5 Discussion and Conclusion\nThe standard implementation of both the ANN ratio and Ripley\u2019s K function exhibits a highly  inflated empirical type I error rate for almost all scenarios considered in the simulation study.  This  phenomenon likely occurs because centroids of the areal units do not arise from a homogeneous  Poisson process under the null hypothesis.  As a result, the centroids of the observed units exhibit  spatial patterns, even when those units are selected with uniform probability.  These findings call  into question the reliability of the current ArcGIS implementation of ANN ratio and Ripley\u2019s K  function for areal data.  The areal implementation of both methods, though imperfect, is far more reliable than the standard  implementation.  The empirical type I error rate of the areal implementation for both the ANN  ratio and Ripley\u2019s K function maintains its nominal level across all scenarios.  The low power of \nthe areal implementation of the ANN method under most of the single clustering scenarios is likely  due to the test statistic being an average of nearest neighbor distances.  The small nearest neighbor  distances for observations in the cluster are offset by the larger neatest neighbor distances between  units outside the cluster, resulting in a less extreme test statistic.  The low power of the areal  implementation of Ripley\u2019s K function for the smallest radius for the Canadian FSAs suggests that  the method may not reliably detect clustering at small distances if the areal units are vastly different  sizes.  Recall that the smallest radius was twice the minimum distance between any two centroids.  For the Canadian FSAs, only 6 (0.02%) pairs of centroids fell within this distance, while 52  (0.03%) pairs of centroids fell within this distance for the US counties and 1482 (1.9%) pairs of  centroids fell within this distance for the regular grid.  The power to detect multiple clustering at  this scale appears to be inversely related to the proportion of centroid pairs falling within the  specified radius.   These findings have important implications for the use of these methods on areal data.  An inflated  type I error rate implies a high false discovery rate, meaning that researchers who have applied  these methods to areal data may have wrongly concluded that their data exhibited a spatial pattern  when in fact it does not.  In epidemiology, this may manifest as the discovery of non-existent  disease clusters or outbreaks.  In ecology, this the misapplication of these methods may lead  researcher to conclude that parcels of conserved land are clustering together to create larger, higher  quality habitats, when in fact they are not.  In civil engineering and urban planning, the use of these  methods could cause researcher to conclude that parcels of land designated for certain uses  (parking, recreation, open space, etc.) are well dispersed throughout an urban area when such is  not the case. As ESRI ArcGIS software automatically applies the standard implementation of these  methods to areal data, these results are particularly concerning for ESRI users. R code which \nhttps://github.com/scwatson812/Areal_ANN_and_Ripleys_K.  The integration of the areal implementation of these methods into ArcGIS and the development of other spatial clustering detection methods which are better suited for areal data is an excellent area for future work.   \n# Funding \nSS and AM were partially supported by National Institutes of Health grant NIGMS  P20GM130420. \nMoeur, M. (1993). Characterizing spatial patterns of trees using stem-mapped data. Forest science,  39(4), 756-775.   Mollalo, A., Alimohammadi, A., Shirzadi, M. R., & Malek, M. R. (2015). Geographic information  system\u2010based analysis of the spatial and spatio\u2010temporal distribution of zoonotic cutaneous  leishmaniasis in Golestan Province, north\u2010east of Iran. Zoonoses and public health, 62(1),  18-28.   Moore, D. A., & Carpenter, T. E. (1999). Spatial analytical methods and geographic information  systems: use in health research and epidemiology. Epidemiologic reviews, 21(2), 143-161.  Qiao, L., Huang, H., & Tian, Y. (2019). The identification and use efficiency evaluation of urban  industrial land based on multi-source data. Sustainability, 11(21), 6149.   Ramis, R., Gomez-Barroso, D., Tamayo, I., Garcia-Perez, J., Morales, A., Pardo Romaguera, E.,  & Lopez-Abente, G. (2015). Spatial analysis of childhood cancer: a case/control study.  PloS one, 10(5), e0127273.   Ripley, B. D. (1976). The second-order analysis of stationary point processes. Journal of applied  probability, 13(2), 255-266.   Ripley, B. D. (1977). Modelling spatial patterns. Journal of the Royal Statistical Society: Series B  (Methodological), 39(2), 172-192.   Ripley, B. D. (1979). Tests of'randomness' for spatial point patterns. Journal of the Royal  Statistical Society: Series B (Methodological), 41(3), 368-374.   Skog, L., Linde, A., Palmgren, H., Hauska, H., & Elgh, F. (2014). Spatiotemporal characteristics  of pandemic influenza. BMC infectious diseases, 14(1), 1-14.   Sterner, R. W., Ribic, C. A., & Schatz, G. E. (1986). Testing for life historical changes in spatial  patterns of four tropical tree species. The Journal of Ecology, 621-633.  \nof two forest communities in Western Carpathians, southern Poland. Vegetatio, 89(1), 1122.   Tang, W., Feng, W., & Jia, M. (2015). Massively parallel spatial point pattern analysis: Ripley\u2019s  K function accelerated using graphics processing units. International Journal of  Geographical Information Science, 29(3), 412-439.   Tonini, M., & Abellan, A. (2014). Rockfall detection from terrestrial LiDAR point clouds: A  clustering approach using R. Journal of Spatial Information Science(8), 95-110.   Upton, G., & Fingleton, B. (1985). Spatial data analysis by example. Volume 1: Point pattern and  quantitative data: John Wiley & Sons Ltd.  Vadlamani, S., & Hashemi, M. (2020). Studying the impact of streetlights on street crime rate  using geo-statistics. Paper presented at the 2020 IEEE 21st International Conference on  Information Reuse and Integration for Data Science (IRI).  Wang, Y., Gui, Z., Wu, H., Peng, D., Wu, J., & Cui, Z. (2020). Optimizing and accelerating space\u2013 time Ripley\u2019s K function based on Apache Spark for distributed spatiotemporal point  pattern analysis. Future Generation Computer Systems, 105, 96-118.   Whallon, R. (1974). Spatial analysis of occupation floors II: the application of nearest neighbor  analysis. American Antiquity, 39(1), 16-34.   Wing, M. G., & Tynon, J. (2006). Crime mapping and spatial analysis in national forests. Journal  of Forestry, 104(6), 293-298.   Wolf, A. (2005). Fifty year record of change in tree spatial patterns within a mixed deciduous  forest. Forest Ecology and management, 215(1-3), 212-223.  \nZhang, G., Huang, Q., Zhu, A.-X., & Keel, J. H. (2016). Enabling point pattern analysis on spatial  big data using cloud computing: optimizing and accelerating Ripley\u2019s K function.  International Journal of Geographical Information Science, 30(11), 2230-2252.   Zhang, Z., Sha, D., Dong, B., Ruan, S., Qiu, A., Li, Y., . . . Yang, C. (2020). Spatiotemporal  patterns and driving factors on crime changing during black lives matter protests. ISPRS  International Journal of Geo-Information, 9(11), 640.   Zipp, K. Y., Lewis, D. J., & Provencher, B. (2017). Does the conservation of land reduce  development? An econometric-based landscape simulation with land market feedbacks.  Journal of Environmental Economics and Management, 81, 19-37.  \n<div style=\"text-align: center;\"><img src=\"https://public-pdf-extract-kit.oss-cn-shanghai.aliyuncs.com/a589/a589d55d-ff68-45ee-96ac-0786ee424ae0.png\" style=\"width: 50%;\"></div>\n<div style=\"text-align: center;\"><img src=\"https://public-pdf-extract-kit.oss-cn-shanghai.aliyuncs.com/ebe9/ebe91af3-4d4f-4a8f-9327-db02faeec8bf.png\" style=\"width: 50%;\"></div>\n<div style=\"text-align: center;\">Figure 2. The regions of higher probability selected (grey) under single cluster (left 20x20 regular grid, middle USA counties in six states and right CA FSAs in three provinces).    </div>\nFigure Error! No text of specified style in document.. Examples datasets  generated for the regular grid under DGMs 1 (top), 2 (middle) and 3 (bottom)  for the smaller sample size (left) and larger sample size (right). \n<div style=\"text-align: center;\"><img src=\"https://public-pdf-extract-kit.oss-cn-shanghai.aliyuncs.com/495a/495afae6-d2c9-4a49-97b4-72b564e58574.png\" style=\"width: 50%;\"></div>\n<div style=\"text-align: center;\">Figure 4. Examples datasets generated for the US counties under DGMs 1 (top), 2 (middle) and 3 (bottom) for the smaller sample size (left) and larger sample size (right). </div>\n<div style=\"text-align: center;\"><img src=\"https://public-pdf-extract-kit.oss-cn-shanghai.aliyuncs.com/a950/a95081ff-0a6a-4259-b350-d025dd1f6a41.png\" style=\"width: 50%;\"></div>\nFigure 5. Examples datasets generated for the Canadians FSAs under DGMs 1  (top), 2 (middle) and 3 (bottom) for the smaller sample size (left) and larger  sample size (right). \nTable 1.  Empirical type I error and empirical power of the ANN ratio. \ud835\udc5b\ud835\udc4e= 400 for regular grid \ud835\udc5b\ud835\udc4e= 549 for USA counties, \ud835\udc5b\ud835\udc4e= 267 for Canadian FSAs.   \n \nWindow \n Empirical type I error/ \nempirical power \nWindow 1 \nWindow 2 \nN \u230a\ud835\udc5b\ud835\udc4e\n10\u230b \n\u230a\ud835\udc5b\ud835\udc4e\n4 \u230b \n\u230a\ud835\udc5b\ud835\udc4e\n10\u230b \n\u230a\ud835\udc5b\ud835\udc4e\n4 \u230b \nDGM \nThe regular grid (A1) \n\ud835\udc3b\ud835\udc5c: CSR: D1 \nS 1.00 \n0.39 \n1.00 \n0.75 \nA 0.05 \n0.05 \n0.05 \n0.04 \n\ud835\udc3b\ud835\udc4e: Single \ncluster: D2 \nS 0.00 \n0.04 \n0.00 \n0.00 \nA 0.34 \n0.12 \n0.18 \n0.08 \n\ud835\udc3b\ud835\udc4e: Multiple \nclusters: D3  \nS 0.00 \n1.00 \n0.00 \n0.53 \nA 1.00 \n1.00 \n0.92 \n0.98 \n \nThe US counties (A2) \n\ud835\udc3b\ud835\udc5c: CSR: D1 \nS 0.99 \n0.35 \n0.01 \n0.06 \nA 0.07 \n0.05 \n0.06 \n0.04 \n\ud835\udc3b\ud835\udc4e: Single \ncluster: D2 \nS 0.00 \n0.27 \n0.36 \n0.24 \nA 0.76 \n0.92 \n0.19 \n0.47 \n\ud835\udc3b\ud835\udc4e: Multiple \nclusters: D3  \nS 0.95 \n1.00 \n0.96 \n0.99 \nA 1.00 \n1.00 \n0.99 \n0.98 \n \nThe Canadian FSAs (A3) \n\ud835\udc3b\ud835\udc5c: CSR: D1 \n \nS 1.00 \n0.99 \n1.00 \n0.83 \nA 0.06 \n0.05 \n0.05 \n0.06 \n\ud835\udc3b\ud835\udc4e: Single \ncluster: D2 \nS 1.00 \n1.00 \n1.00 \n0.76 \nA 0.07 \n0.09 \n0.04 \n0.11 \n\ud835\udc3b\ud835\udc4e: Multiple \nclusters: D3  \nS 1.00 \n1.00 \n1.00 \n0.93 \nA 0.65 \n0.64 \n0.52 \n0.58 \nS: Standard implementation \n \nRadius \n Empirical type I error/ empirical power \nR1 \nR2 \nR3 \nR4 \nR5 \nN \u230a\ud835\udc5b\ud835\udc4e\n10\u230b \n\u230a\ud835\udc5b\ud835\udc4e\n4 \u230b \n\u230a\ud835\udc5b\ud835\udc4e\n10\u230b \n\u230a\ud835\udc5b\ud835\udc4e\n4 \u230b \n\u230a\ud835\udc5b\ud835\udc4e\n10\u230b \n\u230a\ud835\udc5b\ud835\udc4e\n4 \u230b \n\u230a\ud835\udc5b\ud835\udc4e\n10\u230b \n\u230a\ud835\udc5b\ud835\udc4e\n4 \u230b \n\u230a\ud835\udc5b\ud835\udc4e\n10\u230b \n\u230a\ud835\udc5b\ud835\udc4e\n4 \u230b \nDGM \nThe regular grid (A1) \n\ud835\udc3b\ud835\udc5c: CSR: D1 \nS 0.98 \n1.00 \n0.91 \n0.99 \n0.81 \n0.76 \n0.80 \n0.50 \n0.90 \n0.99 \nA 0.08 \n0.03 \n0.08 \n0.03 \n0.07 \n0.06 \n0.06 \n0.05 \n0.06 \n0.03 \n\ud835\udc3b\ud835\udc4e: Single \ncluster: D2 \nS 0.88 \n0.96 \n0.99 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \nA 0.95 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n\ud835\udc3b\ud835\udc4e: Multiple \nclusters: D3  \nS 1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n0.99 \n1.00 \n0.79 \nA 1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n0.97 \n0.99 \n0.93 \n \nThe US counties (A2) \n\ud835\udc3b\ud835\udc5c: CSR: D1 \nS 1.00 \n1.00 \n0.82 \n0.63 \n0.80 \n0.72 \n0.73 \n0.67 \n0.68 \n0.58 \nA 0.09 \n0.02 \n0.04 \n0.04 \n0.04 \n0.07 \n0.07 \n0.05 \n0.05 \n0.05 \n\ud835\udc3b\ud835\udc4e: Single \ncluster: D2 \nS 0.17 \n0.00 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \nA 0.65 \n0.98 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n\ud835\udc3b\ud835\udc4e: Multiple \nclusters: D3  \nS 0.36 \n0.00 \n1.00 \n1.00 \n0.99 \n0.98 \n0.86 \n0.85 \n0.74 \n0.69 \nA 0.77 \n0.76 \n1.00 \n1.00 \n0.95 \n0.85 \n0.68 \n0.55 \n0.49 \n0.42 \n \nThe Canadian FSAs (A3) \n\ud835\udc3b\ud835\udc5c: CSR: D1 \n \nS 0.06 \n0.35 \n1.00 \n1.00 \n1.00 \n1.00 \n0.98 \n1.00 \n0.87 \n0.91 \nA 0.05 \n0.00 \n0.06 \n0.05 \n0.03 \n0.04 \n0.06 \n0.05 \n0.05 \n0.06 \n\ud835\udc3b\ud835\udc4e: Single \ncluster: D2 \nS 0.35 \n0.31 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \nA 0.06 \n0.01 \n0.68 \n0.97 \n0.93 \n1.00 \n0.98 \n1.00 \n1.00 \n1.00 \n\ud835\udc3b\ud835\udc4e: Multiple \nclusters: D3  \nS 0.53 \n0.50 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n1.00 \n0.83 \n0.80 \nA 0.19 \n0.06 \n0.74 \n0.61 \n0.66 \n0.55 \n0.44 \n0.39 \n0.34 \n0.30 \nS: Standard implementation \n",
    "paper_type": "benchmark",
    "attri": {
        "background": {
            "problem background": "Spatial clustering detection methods are widely used in various fields including epidemiology, ecology, biology, physics, and sociology, often focusing on areal data which may arise from spatial aggregation or inherent attributes of areal units. Despite their popularity, little research has evaluated the properties of these methods in the context of areal data, leading to the necessity for a benchmark that accurately assesses their performance.",
            "purpose of benchmark": "The benchmark is intended to evaluate the performance of two spatial clustering detection methods, the average nearest neighbor (ANN) ratio and Ripley\u2019s K function, specifically for areal data. It aims to compare these methods under various areal structures and types of spatial dependence."
        },
        "problem": {
            "definition": "The benchmark addresses the challenge of accurately detecting spatial clustering in areal data using traditional methods that were originally designed for point process data.",
            "key obstacle": "The main challenge is that existing benchmarks do not adequately account for the unique properties of areal data, leading to inflated empirical type I error rates when applying traditional hypothesis testing methods."
        },
        "idea": {
            "intuition": "The development of this benchmark is inspired by the observation that traditional methods like the ANN ratio and Ripley\u2019s K function, while popular, have not been rigorously tested for their effectiveness on areal data, which often violates the assumptions of these methods.",
            "opinion": "The authors believe that this benchmark is crucial for improving the reliability of spatial clustering analyses in areal data, which can have significant implications in fields such as public health and urban planning.",
            "innovation": "This benchmark introduces an alternative implementation of the ANN ratio and Ripley\u2019s K function that utilizes Monte Carlo methods tailored for areal data, addressing the limitations of the standard implementations.",
            "benchmark abbreviation": "ANN-RK"
        },
        "dataset": {
            "source": "The dataset was generated through simulation studies that create areal unit structures with varying characteristics to evaluate the performance of the clustering methods.",
            "desc": "The dataset consists of simulated areal unit structures with different sizes and shapes, specifically designed to reflect real-world scenarios in spatial clustering analysis.",
            "content": "The dataset includes spatial locations represented as centroids of areal units, which are used to apply the ANN ratio and Ripley\u2019s K function.",
            "size": "1,216",
            "domain": "Spatial Analysis",
            "task format": "Hypothesis Testing"
        },
        "metrics": {
            "metric name": "Empirical Type I Error Rate, Empirical Power",
            "aspect": "Accuracy of clustering detection methods",
            "principle": "The metrics were chosen based on their ability to evaluate the reliability and effectiveness of the clustering methods under the null hypothesis and alternative hypotheses.",
            "procedure": "Model performance is evaluated by comparing the observed test statistics to a null distribution estimated through Monte Carlo simulations."
        },
        "experiments": {
            "model": "The benchmark tested both the ANN ratio and Ripley\u2019s K function using a mix of standard and areal implementations.",
            "procedure": "The experiments involved generating datasets under different spatial dependence scenarios and applying both clustering methods to assess their performance in detecting spatial patterns.",
            "result": "The results indicated that the areal implementation of both methods maintained nominal type I error rates, while the standard implementation exhibited inflated rates, particularly in certain scenarios.",
            "variability": "Variability was accounted for through multiple trials across different areal structures and sample sizes, ensuring robust evaluation of the methods."
        },
        "conclusion": "The study concludes that the areal implementation of the ANN ratio and Ripley\u2019s K function is significantly more reliable than the standard implementation, which tends to yield inflated type I error rates.",
        "discussion": {
            "advantage": "The benchmark provides a more accurate framework for assessing spatial clustering in areal data, potentially leading to better decision-making in public health and urban planning.",
            "limitation": "The benchmark may still have limitations in detecting clustering at very small scales, particularly when areal units vary significantly in size.",
            "future work": "Future research should focus on integrating the areal implementation into popular GIS software and exploring new spatial clustering detection methods better suited for areal data."
        },
        "other info": {
            "funding": "Partially supported by National Institutes of Health grant NIGMS P20GM130420.",
            "repository": "R code and additional resources are available at https://github.com/scwatson812/Areal_ANN_and_Ripleys_K."
        }
    },
    "mount_outline": [
        {
            "section number": "1.1",
            "key information": "The benchmark addresses the challenge of accurately detecting spatial clustering in areal data using traditional methods that were originally designed for point process data."
        },
        {
            "section number": "1.2",
            "key information": "The authors believe that this benchmark is crucial for improving the reliability of spatial clustering analyses in areal data, which can have significant implications in fields such as public health and urban planning."
        },
        {
            "section number": "1.3",
            "key information": "The benchmark is intended to evaluate the performance of two spatial clustering detection methods, the average nearest neighbor (ANN) ratio and Ripley\u2019s K function, specifically for areal data."
        },
        {
            "section number": "2.1",
            "key information": "Spatial clustering detection methods are widely used in various fields including epidemiology, ecology, biology, physics, and sociology, often focusing on areal data which may arise from spatial aggregation or inherent attributes of areal units."
        },
        {
            "section number": "2.2",
            "key information": "Despite their popularity, little research has evaluated the properties of these methods in the context of areal data, leading to the necessity for a benchmark that accurately assesses their performance."
        },
        {
            "section number": "4.1",
            "key information": "The benchmark provides a more accurate framework for assessing spatial clustering in areal data, potentially leading to better decision-making in public health and urban planning."
        },
        {
            "section number": "7.1",
            "key information": "The benchmark may still have limitations in detecting clustering at very small scales, particularly when areal units vary significantly in size."
        },
        {
            "section number": "7.4",
            "key information": "Future research should focus on integrating the areal implementation into popular GIS software and exploring new spatial clustering detection methods better suited for areal data."
        }
    ],
    "similarity_score": 0.5657157304751879,
    "image": null,
    "path": "/home/dany/codes/autosurvey/outputs/2025-01-11-2055_semi-/papers/Cluster Detection Capabilities of the Average Nearest Neighbor Ratio and Ripley's K Function on Areal Data_ an Empirical Assessment.json"
}