{
    "from": "arxiv",
    "scholar_id": null,
    "detail_id": "arXiv:2002.04563",
    "title": "Mathematical Foundations of Regression Methods for the approximation of the Forward Initial Margin",
    "abstract": "Abundant literature has been published on approximation methods for the forward initial margin. The most popular ones being the family of regression methods. This paper describes the mathematical foundations on which these regression approximation methods lie. We introduce mathematical rigor to show that in essence, all the methods propose variations of approximations for the conditional expectation function, which is interpreted as an orthogonal projection on Hilbert spaces. We show that each method is simply choosing a different functional form to numerically estimate the conditional expectation. We cover in particular the most popular methods in the literature so far, Polynomial approximation, Kernel regressions and Neural Networks.",
    "bib_name": "kun2022mathematicalfoundationsregressionmethods",
    "md_text": "# Mathematical Foundations of Regression Methods for Approximating the Forward Initial Margin\n# Lucia Cipolina-Kun1, Simone Caenazzo2, and Ksenia Ponomareva2 1University of Bristol. Department of Electrical and Electronic Engineering 2Riskcare Ltd., London\n# September 30, 2022\nAbstract\nThe modelling of forward initial margin poses a challenging problem as it requires the implementation of a nested Monte Carlo simulation, which is computationally intractable. Abundant literature has been published on approximation methods aiming to reduce the dimensionality of the problem, the most popular ones being the family of regression methods. This paper describes the mathematical foundations, on which these regression approximation methods lie. Mathematical rigor is introduced to show that, in essence, all methods are performing orthogonal projections on Hilbert spaces, while simply choosing a different functional form to numerically estimate the conditional expectation. The most popular methods in the literature so far are covered here. These are polynomial approximations, Kernel regressions and Neural Networks.\n# 1 Introduction\nInitial margin (IM) has become a topic of high relevance for the financial industry in recent years. The relevance stems from its wide implications to the way business will be conducted in the financial industry and in addition, for the need of approximation methods to calculate it. We refer to initial margin as a collateral posted and/or received in the context of OTC transactions. Its main purpose is to reduce future exposure in the event of a counterparty default. It differs from variation margin as:\n\u2022 It is a segregated amount, that must be held into a third-party account (such that of a custodian bank) and cannot be pledged as offset to any other liability.\nThe initial margin amount is calculated at the netting set level following a set of rules depending on whether the trade has been done bilaterally [16] or facing a Clearing House [7]. The calculation is performed on a daily basis and carried on throughout the life of the trade. Since each netting set consumes initial margin throughout its entire life, financial institutions need resources to fund this amount in the future, given that the initial margin received from its counterparty cannot be rehypothecated. To estimate the total need for funds, each counterparty needs to perform a forecast of the initial margin amount up to the time to maturity of the netting set, this forecast of initial margin consumption is denoted as forward initial margin. Forecasting initial margin amounts is a computationally challenging problem, as an exact calculation requires a full implementation of a nested Monte Carlo simulation which is computationally onerous in most practical settings. Practitioners and academics have proposed several approximation methods to reduce the dimensionality of the problem, at the cost of losing a tolerable degree of accuracy. Some examples are the Chebyshev polynomials proposed by [26], automatic differentiation methods proposed by [14], Gaussian processes [11], and regression methods [10]. Among all, regression methods have been the most widely spread due to their simplicity, re-usability of the Bank\u2019s legacy Monte Carlo engines, and reasonable results. Inspired by early works of LongstaffSchwartz [19], several authors have proposed some version of the polynomial regression, [1, 8, 10], or the Kernel regressions proposed by [2, 10, 12]. Most recently, estimation by Neural Networks has been proposed by [15] and [21]. The financial literature on forward initial margin has focused on the implementation aspects of regression methods from a practical point of view. The current literature is mainly focused on the the applicability and performance of the different methodologies, without dwelling on mathematical formalities. It is here where our paper finds its value, i.e. by filling the current gap between theory and practice.\n# The contribution of this paper can be summarized as follows:\n\u2022 To the best of our knowledge, the present work is the first one that aims at describing the rigorous mathematical framework behind regression methodologies for determining the forward initial margin.\n\u2022 Unlike the current literature, our emphasis is placed on the mathematical conditions needed for regression methods to be accurate unbiased estimators of the forward initial margin. In particular, we emphasize the Markovian property and the necessary conditions placed on the Mark-to-market processes. Note that MtM processes are not, in general, guaranteed to have such properties.\n\u2022 The paper draws a clear demarcation line between assumptions, necessary conditions and empirical calls, paying particular attention to the choice of regressor variables.\nThe underlying mathematical framework required to analyze the forward initial margin computation problem from a theoretical standpoint is presented\nThe underlying mathematical framework required to analyze the forward initial margin computation problem from a theoretical standpoint is presented here.\nThe rest of this paper is organized as follows. Section 2 translates the practitioner\u2019s definition of the forward initial margin into a formal probability setting. Sections 3-4 develop the assumptions needed to fit the forward initial margin problem into a classical problem of orthogonal projections into Hilbert spaces. The last section concludes by linking back the formal theory presented with the practitioner\u2019s suggested approaches.\n# 2 Description of the Forward Initial Margin Prob lem\n2.1 Definition of Forward Initial Margin\nA Bank engaged in OTC transactions needs to calculate the total cost associated with the posting of initial margin to a counterparty over the life of a netting set. Since this quantity evolves in time, it is necessary to consider a forward diffusion model, together with a probability space and the relevant discounting and funding rates into the equation.\nConsider a filtered probability space (\u2126, F, {Ft}t\u22650 , P) where \u2126is the set of all possible sample paths \u03c9 , F is the sigma-algebra,{Ft} is the filtration of events at time t and P the probability measure defined on the elements of F. Following the definitions in [6], the total cost of posting forward initial margin over the entire life of a netting set is referred to as the Margin Valuation Adjustment as defined below.\nMV AC(t) = Et \ufffd\ufffdT t ((1 \u2212RC)\u03bbB(u) \u2212SI(u))e \ufffdu t \u2212(r(s)+\u03bbB(s)+\u03bbC(s))dsEu [IMC(u)] du \ufffd (1) where, Et denotes an expectation conditional to information at time t, i.e. Et [. . . ] = E [\u00b7 \u00b7 \u00b7 | Ft] , RC(t) is the recovery rate of the counterparty related to netting set C, T is the final maturity of netting set C, SI is the funding spread experienced by the bank when borrowing the initial margin amount, r(t) is the risk-free rate (e.g. an OIS rate) at time t, \u03bbB(t), \u03bbC(t) are the financing rates (i.e. spreads over risk-free rate) at time t of the Bank and the counterparty related to netting set C, respectively, IMC(t) is the initial margin posted by the bank at time t against netting set C.\nMV AC(t) = Et \ufffd\ufffdT t ((1 \u2212RC)\u03bbB(u) \u2212SI(u))e \ufffdu t \u2212(r(s)+\u03bbB(s)+\u03bbC(s))dsEu [IMC(u)] d (1)\nMV AC(t) = Et \ufffd\ufffdT t ((1 \u2212RC)\u03bbB(u) \u2212SI(u))e \ufffdu t \u2212(r(s)+\u03bbB(s)+\u03bbC(s))dsEu [IMC(u)] du \ufffd (1) where, Et denotes an expectation conditional to information at time t, i.e. Et [. . . ] = E [\u00b7 \u00b7 \u00b7 | Ft] , RC(t) is the recovery rate of the counterparty related to netting set C, T is the final maturity of netting set C, SI is the funding spread experienced by the bank when borrowing the initial margin amount, r(t) is the risk-free rate (e.g. an OIS rate) at time t, \u03bb(t), \u03bb(t) are the financing\nwhere, Et denotes an expectation conditional to information at time t, i.e. Et [. . . ] = E [\u00b7 \u00b7 \u00b7 | Ft] , RC(t) is the recovery rate of the counterparty related to netting set C, T is the final maturity of netting set C, SI is the funding spread experienced by the bank when borrowing the initial margin amount, r(t) is the risk-free rate (e.g. an OIS rate) at time t, \u03bbB(t), \u03bbC(t) are the financing rates (i.e. spreads over risk-free rate) at time t of the Bank and the counterparty related to netting set C, respectively, IMC(t) is the initial margin posted by the bank at time t against netting set C. The intuition behind this formula is that it integrates three components:\n# \u2022 The cost of funding forward Initial Margin for the bank;\n\u2022 The discounting of forward Initial Margin amounts, which also includes the impact of early default as characterised by the bank\u2019s and counterparty\u2019s funding spreads.\nNote that we have used the concept of netting set and counterparty. In general, a netting set is an ensemble of trades for which netting is allowed - therefore there is a one-to-many relationship between counterparty and netting sets, as one counterparty may hold more than one netting set when facing a bank. Furthermore, note that the expectation Et is taken on the whole integral. This is because certain simulation setups, like the ones in [24] and [25], explicitly model credit factors that lead to stochastic credit spreads and survival probabilities. If the simulation setup instead considers deterministic credit factors, the formula can be simplified as follows:\nMV AC(t) = \ufffdT t ((1 \u2212RC)\u03bbB(u) \ufffd\nHere the quantity of interest is Et [IM(t)], which is a short for Et [IMC(\u03c9, t, t + \u03b4IM) This is the expectation of the initial margin at time t, taken across all random paths \u03c9, conditional on the realization of the risk factors at time t. The forward initial margin is a path-wise random variable defined as 1\nP(\u2206t \u2264IM(\u03c9, t, t + \u03b4IM)|Ft) = p\nWhere p denotes the desired quantile (usually the 99% quantile), \u2206(\u03c9, t, \u03b4IM) is defined (in its simplest form2) as the change, conditional on counterparty default, in the netting set\u2019s value (i.e. profit and loss (PnL)) over a time interval\nWhere p denotes the desired quantile (usually the 99% quantile), \u2206(\u03c9, t, \u03b4IM) is defined (in its simplest form2) as the change, conditional on counterparty default, in the netting set\u2019s value (i.e. profit and loss (PnL)) over a time interval (t, t + \u03b4IM]. The following sections describe the computational methods developed in the current literature to estimate this quantity.\nWhere p denotes the desired quantile (usually the 99% quantile), \u2206(\u03c9, t, \u03b4IM) is defined (in its simplest form2) as the change, conditional on counterparty default, in the netting set\u2019s value (i.e. profit and loss (PnL)) over a time interval (t, t + \u03b4IM].\nThe following sections describe the computational methods developed in the current literature to estimate this quantity.\n# 2.2 The Brute Force Approach to Calculate the Forward Initial Margin\n# 2.2 The Brute Force Approach to Calculate the Forward\nFrom a computational point of view, equation 1 can be abstracted to a nested Monte Carlo problem, where two expectations are chained\n1This is the simplest definition of forward initial margin, for alternative definitions see [3]. 2This is the simplest definition of netting set PnL, for further including cash flow adjustments see [3].\n(2)\nThe most exact method to calculate the forward initial margin requires a brute force implementation of a nested Monte Carlo simulation where for each sample of V (\u03c9, t), one would draw i.i.d samples of V (\u03c9, t+\u03b4IM)|V (\u03c9, t) . The left side of Figure ?? exemplifies the situation. For a given point in time, t1, an outer Monte Carlo simulation for the values of V (\u03c9, t1) and an inner Monte Carlo simulation of the forward Probability Density Function (PDF) of (V (\u03c9, t1 + \u03b4IM) | Ft1) have been performed. The difference in the value of the netting set between t1 and t1 + \u03b4IM time steps is \u2206(\u03c9, t1, \u03b4IM). Since the PDF distribution of (V (\u03c9, t1 + \u03b4IM) | Ft1) is known, it is possible to obtain the PDF distribution of \u2206(\u03c9, t1, \u03b4IM). Then, one should take the Q99 to obtain the forward initial margin. Note that the number of scenarios on the tail should be sufficiently large to allow a reliable quantile estimation. Such a brute force calculation of the forward initial margin is computationally onerous given that the number of operations increase exponentially. This type of complexity is generally not possible to afford in a real-time live trading scenario, thus requiring approximation methods.\n# 3 Summary\nThe table below provides advantages and disadvantages from the practitioners\u2019 point of view of the methods covered.\nMethod\nm(Xt, \u02c6\u03b2)\nPros and Cons\nLinear\nMaps\n\ufffdN\ni=0 \u02c6\u03b2i \u00b7 \u03c6i(Xt)\n\u02c6\u03b2 \u2208RN\n\u03c6i\n-\nlinear\nbasis\nfunctions\nN - degree of poly-\nnomial\n+ Same few calibrated parameters are\nused across all simulation scenarios and\ntime steps.\n+ Computationally cheap compared to\nthe two other methods.\n- Large oscillations in the calibrated pa-\nrameters can be observed due to daily\nchange in IM value at t0.\n- In a distributed grid setup a small sim-\nulation run is required to pre-compute\n\u02c6\u03b2i prior to the main MC simulation.\nKernel\nRegres-\nsions\n(NW)\n\ufffdN\ni=0 \u02c6\u03b2i \u00b7 \u03c6i(Xt)\n\u02c6\u03b2i =\nKh(x0,xi)\n\ufffdN\nj=1 Kh(x0,xj)\n\u03c6i = yi\nN\n-\nnumber\nof\nneighbourhood\npairs (xi, yi)\nKh - Kernel func-\ntion\n+ Computationally cheap\n+ Better empirical fit to data than lin-\near regression.\n+ Ensures functional smoothness.\n- Assumes parametric functional form.\n- It could be challenging to obtain sen-\nsitivities to model parameters and in-\nputs.\nFeed-\nForward\nNeural\nNetworks\n\ufffdN\ni=0 \u02c6\u03b2i \u00b7 \u03c6i(Xt)\n\u02c6\u03b2i\n= W i\nL, weight\napplied to the out-\nput of the neuron i\nin the final hidden\nlayer\n\u03c6i(Xt) = Ai\nL - ac-\ntivation of the neu-\nron i in the final\nhidden layer\nN - number of neu-\nrons\nin\nthe\nfinal\nhidden layer (plus\n1 if incorporating\nbias)\n+ Once trained, predicted IM can be\ncalculated extremely fast because it\nonly involves small scale matrix multi-\nplication and is done at the portfolio\nlevel.\n+ \u02c6\u03b2i only need to be updated every\nquarter compared to daily in linear\nmaps method.\n- Training requires portfolio sensitivi-\nties for each MC path and time-step per\nSIMM model requirements.\n- Data generation for training is com-\nputationally expensive and needs to be\ndone offline.\n# References\n[27] Carr, Peter and Wu, Liuren and Zhang, Zhibai Using Machine Learning to Predict Realized Variance (2019). Available at arXiv preprint https://arxiv.org/pdf/1909.10035.pdf\n",
    "paper_type": "theory",
    "attri": {
        "background": "The modelling of forward initial margin is crucial for financial institutions as it impacts how they manage counterparty risk and collateral requirements in OTC transactions. The challenge lies in its computational complexity, necessitating approximation methods to facilitate feasible calculations.",
        "problem": {
            "definition": "The problem involves calculating the total cost associated with posting initial margin over the life of a netting set, which evolves over time and requires a forward diffusion model.",
            "key obstacle": "The main difficulty is the computational burden of performing nested Monte Carlo simulations, which are often intractable in practical settings."
        },
        "idea": {
            "intuition": "The idea was inspired by the need to find efficient approximation methods to estimate forward initial margin without relying on exhaustive computational approaches.",
            "opinion": "The paper proposes that existing regression methods can be rigorously grounded in mathematical theory to improve their accuracy and reliability.",
            "innovation": "The primary improvement is the introduction of a formal mathematical framework that establishes the conditions under which regression methods can serve as unbiased estimators of forward initial margin."
        },
        "Theory": {
            "perspective": "The theoretical perspective focuses on the application of orthogonal projections in Hilbert spaces to model the forward initial margin problem.",
            "opinion": "The authors argue that mathematical rigor is necessary to bridge the gap between practical implementations and theoretical foundations in the literature.",
            "proof": "The paper provides mathematical derivations demonstrating that regression methods essentially perform orthogonal projections on Hilbert spaces."
        },
        "experiments": {
            "evaluation setting": "The evaluation involves comparing various regression methods including polynomial approximations, Kernel regressions, and Neural Networks, using datasets relevant to financial transactions and margin calculations.",
            "evaluation method": "The evaluation steps include assessing the accuracy and computational efficiency of each method against the brute force Monte Carlo approach."
        },
        "conclusion": "The paper concludes that the proposed mathematical framework enhances the understanding of regression methods for estimating forward initial margin and provides conditions for their unbiasedness.",
        "discussion": {
            "advantage": "The main advantage is the rigorous mathematical foundation that improves the reliability and interpretability of regression methods for practitioners.",
            "limitation": "A limitation is that the mathematical conditions required for unbiased estimation may not always hold in practical scenarios, potentially affecting accuracy.",
            "future work": "Future research could focus on refining the mathematical conditions and exploring hybrid approaches that combine the strengths of different regression techniques."
        },
        "other info": []
    },
    "mount_outline": [
        {
            "section number": "1.1",
            "key information": "The modelling of forward initial margin is crucial for financial institutions as it impacts how they manage counterparty risk and collateral requirements in OTC transactions."
        },
        {
            "section number": "1.4",
            "key information": "The paper proposes that existing regression methods can be rigorously grounded in mathematical theory to improve their accuracy and reliability."
        },
        {
            "section number": "2.1",
            "key information": "The theoretical perspective focuses on the application of orthogonal projections in Hilbert spaces to model the forward initial margin problem."
        },
        {
            "section number": "5.1",
            "key information": "The primary improvement is the introduction of a formal mathematical framework that establishes the conditions under which regression methods can serve as unbiased estimators of forward initial margin."
        },
        {
            "section number": "7.1",
            "key information": "A limitation is that the mathematical conditions required for unbiased estimation may not always hold in practical scenarios, potentially affecting accuracy."
        }
    ],
    "similarity_score": 0.578934007410615,
    "image": null,
    "path": "/home/dany/codes/autosurvey/outputs/2025-01-11-1421_trans/papers/Mathematical Foundations of Regression Methods for the approximation of the Forward Initial Margin.json"
}